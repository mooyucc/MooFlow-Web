# 布局方向导出导入功能说明

## 功能概述

现在MooFlow支持在导出文件时记录布局方向（水平/垂直），并在导入时正确还原布局设置。

## 功能特性

### 1. 导出功能增强
- 导出文件时自动包含布局方向信息
- 兼容旧格式：旧版本导出的文件仍然可以正常导入
- 导出文件包含完整的画布属性信息

### 2. 导入功能增强
- 导入时自动还原布局方向
- 支持新旧格式兼容
- 自动更新画布属性

### 3. 文件格式

#### 新格式（包含布局信息）
```json
{
  "tasks": [...],
  "mainDirection": "horizontal",
  "canvasProps": {
    "mainDirection": "horizontal",
    "backgroundColor": "#ebebeb",
    "showGrid": true,
    ...
  }
}
```

#### 旧格式兼容（仅任务数组）
```json
[
  {...},
  {...}
]
```

## 使用方法

### 导出文件
1. 在画布中设置好布局方向（水平或垂直）
2. 点击导出按钮
3. 选择保存位置
4. 文件将包含当前的布局方向信息

### 导入文件
1. 点击导入按钮
2. 选择之前导出的文件
3. 系统会自动还原布局方向
4. 任务卡片会按照保存的布局方向重新排列

## 技术实现

### 主要修改文件
- `src/components/CanvasFileToolbar.jsx`：导出导入逻辑
- `src/components/MainCanvas.jsx`：布局方向应用
- `src/components/FormatSidebar.jsx`：布局切换界面

### 关键功能点
1. **导出时记录布局**：在导出数据中包含 `mainDirection` 和 `canvasProps`
2. **导入时还原布局**：解析导入文件并设置相应的布局方向
3. **兼容性处理**：支持旧格式文件的导入
4. **实时同步**：布局方向变化时自动同步到文件存储

## 注意事项

1. 旧版本导出的文件仍然可以正常导入，会使用默认的水平布局
2. 布局方向信息会保存在本地存储中，切换文件时会自动应用
3. 导入文件后，建议使用"自动排列"功能来优化卡片位置 